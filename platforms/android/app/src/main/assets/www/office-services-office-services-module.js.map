{"version":3,"sources":["./src/app/presentation/office-services/components/action-step-card/action-step-card.component.ts","./src/app/presentation/office-services/components/action-step-card/action-step-card.component.html","./src/app/presentation/office-services/office-services-routing.module.ts","./src/app/shared/layout/extra-title-tpl/extra-title-tpl.component.ts","./src/app/presentation/office-services/page/office-services.component.ts","./src/app/presentation/office-services/page/office-services.component.html","./src/app/presentation/office-services/office-services.module.ts","./src/app/shared/layout/extra-title-tpl/extra-title-tpl.module.ts"],"names":[],"mappings":"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","file":"office-services-office-services-module.js","sourcesContent":["import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  Output,\r\n  SimpleChanges,\r\n  TemplateRef,\r\n} from '@angular/core';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport {\r\n  StepAction,\r\n  StepParam,\r\n} from '../../../../shared/office-services/models/order-services.model';\r\n@Component({\r\n  selector: 'action-step-card',\r\n  templateUrl: './action-step-card.component.html',\r\n  styleUrls: ['./action-step-card.component.less'],\r\n})\r\nexport class ActionStepCardComponent implements OnChanges {\r\n  @Input()\r\n  public action: StepAction;\r\n\r\n  @Input()\r\n  public title = '';\r\n\r\n  @Input()\r\n  public dateTimeFormat;\r\n\r\n  @Input()\r\n  public isLoading: boolean;\r\n\r\n  @Input()\r\n  public showActionTmpl: boolean;\r\n\r\n  @Output()\r\n  public nextAction: EventEmitter<void> = new EventEmitter<void>();\r\n\r\n  @Output()\r\n  public commitSession: EventEmitter<void> = new EventEmitter<void>();\r\n\r\n  @Output()\r\n  public cancelSession: EventEmitter<void> = new EventEmitter<void>();\r\n\r\n  stepForm: FormGroup;\r\n\r\n  constructor(private formBuilder: FormBuilder) {}\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes && changes.action && changes.action.currentValue) {\r\n      this.createForm();\r\n    }\r\n  }\r\n\r\n  getTitle(): string {\r\n    return this.isLastStep\r\n      ? this.title + ', проверка введенных данных'\r\n      : this.title + ', шаг ' + this.stepNumber;\r\n  }\r\n\r\n  get currentStepParams(): StepParam[] {\r\n    return this.action ? this.action.params : [];\r\n  }\r\n\r\n  get isLastStep(): boolean {\r\n    return this.action ? this.action.isLastStep : false;\r\n  }\r\n\r\n  get stepNumber(): number {\r\n    return this.action ? this.action.step : 1;\r\n  }\r\n\r\n  get displayedStepParams(): StepParam[] {\r\n    return this.currentStepParams.filter(\r\n      (stepParam) =>\r\n        stepParam.dataType.type === 'STRING' ||\r\n        stepParam.dataType.type === 'INTEGER' ||\r\n        stepParam.dataType.type === 'DICTIONARY' ||\r\n        stepParam.dataType.type === 'DATETIME'\r\n    );\r\n  }\r\n\r\n  createForm(): void {\r\n    this.stepForm = this.formBuilder.group({\r\n      params: this.formBuilder.array(this.createParams(this.currentStepParams)),\r\n    });\r\n  }\r\n\r\n  createParams(params: StepParam[]): FormGroup[] {\r\n    return params\r\n      ? params.map((param) => {\r\n          let validator = [];\r\n          if (param.isOptional == false) {\r\n            validator.push(Validators.required);\r\n          }\r\n          return this.formBuilder.group({\r\n            field: new FormControl(null, validator),\r\n          });\r\n        })\r\n      : [];\r\n  }\r\n\r\n  actionNext(): void {\r\n    this.nextAction.emit();\r\n  }\r\n\r\n  actionCommit(): void {\r\n    this.commitSession.emit();\r\n  }\r\n\r\n  actionCancel(): void {\r\n    this.cancelSession.emit();\r\n  }\r\n}\r\n","<nz-card\r\n  [nzTitle]=\"getTitle()\"\r\n  class=\"scenarios-card\"\r\n  [nzActions]=\"showActionTmpl ? [actionTmpl] : []\"\r\n>\r\n  <form\r\n    nz-form\r\n    [nzLayout]=\"'inline'\"\r\n    [formGroup]=\"stepForm\"\r\n    *ngIf=\"!isLastStep; else lastStepForm\"\r\n  >\r\n    <div class=\"grid-form-items\" nz-row [nzGutter]=\"[16, 24]\">\r\n      <div\r\n        nz-col\r\n        [nzSpan]=\"8\"\r\n        *ngFor=\"let param of currentStepParams; let i = index\"\r\n      >\r\n        <custom-input\r\n          [stepForm]=\"stepForm\"\r\n          [param]=\"param\"\r\n          [index]=\"i\"\r\n          [dateFormat]=\"dateTimeFormat\"\r\n        ></custom-input>\r\n      </div>\r\n    </div>\r\n  </form>\r\n  <ng-template #lastStepForm>\r\n    <form nz-form nzLayout=\"vertical\">\r\n      <div class=\"grid-form-items\" nz-row [nzGutter]=\"[16, 24]\">\r\n        <div\r\n          nz-col\r\n          [nzSpan]=\"8\"\r\n          *ngFor=\"let param of displayedStepParams; let i = index\"\r\n        >\r\n          <custom-output\r\n            [param]=\"param\"\r\n            [dateFormat]=\"dateTimeFormat\"\r\n          ></custom-output>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  </ng-template>\r\n</nz-card>\r\n\r\n<ng-template #actionTmpl>\r\n  <div class=\"action-tmpl\">\r\n    <button nz-button nzType=\"default\" (click)=\"actionCancel()\">Отмена</button>\r\n    <button\r\n      nz-button\r\n      nzType=\"primary\"\r\n      *ngIf=\"!isLastStep\"\r\n      [disabled]=\"stepForm.invalid\"\r\n      [nzLoading]=\"isLoading\"\r\n      (click)=\"actionNext()\"\r\n    >\r\n      Далее\r\n    </button>\r\n    <button\r\n      nz-button\r\n      nzType=\"primary\"\r\n      (click)=\"actionCommit()\"\r\n      [nzLoading]=\"isLoading\"\r\n      *ngIf=\"isLastStep\"\r\n    >\r\n      Отправить заявку\r\n    </button>\r\n  </div>\r\n</ng-template>\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { OfficeServicesomponent } from './page/office-services.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: OfficeServicesomponent,\r\n    data: {\r\n      title: 'Услуги в офисе'\r\n    }\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class OfficeServicesRoutingModule {}\r\n","import { ChangeDetectionStrategy, Component, Input, TemplateRef, ViewChild } from '@angular/core';\r\nimport { LayoutSharedService } from '@app/layout/layout-shared.service';\r\n\r\n@Component({\r\n  selector: 'app-extra-title-tpl',\r\n  template: `<ng-template #contentTpl><ng-content></ng-content></ng-template>`,\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ExtraTitleTplComponent {\r\n  @Input()\r\n  public static: boolean = false;\r\n  @ViewChild('contentTpl')\r\n  public set content(value: TemplateRef<any>) {\r\n    this._layoutService.extra = value;\r\n  }\r\n  constructor(private _layoutService: LayoutSharedService) {}\r\n}\r\n","import { TemplateRef } from '@angular/core';\r\nimport {\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  Component,\r\n  OnInit,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { Subscriptions } from '@src/app/core/decorators/subscriptions.decorator';\r\nimport { PerfectScrollDirective } from '@src/app/core/directives/perfect-scroll.directive';\r\nimport { LayoutSharedService } from '@src/app/layout/layout-shared.service';\r\nimport {\r\n  Scenario,\r\n  StepAction,\r\n} from '@src/app/shared/office-services/models/order-services.model';\r\nimport { ServiceStepType } from '@src/app/shared/office-services/models/service-step-type.enum';\r\nimport { OrderServicesService } from '@src/app/shared/office-services/order-services.service';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { BehaviorSubject, Subscription } from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'app-office-services',\r\n  templateUrl: './office-services.component.html',\r\n  styleUrls: ['./office-services.component.less'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  providers: [OrderServicesService],\r\n})\r\nexport class OfficeServicesomponent implements OnInit {\r\n  @Subscriptions()\r\n  sub: Subscription;\r\n\r\n  loading = new BehaviorSubject<boolean>(null);\r\n\r\n  stepType: ServiceStepType = ServiceStepType.INITIAL;\r\n  ServiceStepType = ServiceStepType;\r\n\r\n  scenarios: Scenario[] | undefined;\r\n  selectedScenario: Scenario | undefined;\r\n\r\n  actions: StepAction[] = [];\r\n\r\n  url: string;\r\n\r\n  stepForm: FormGroup;\r\n  public dateTimeFormat;\r\n\r\n  @ViewChild(PerfectScrollDirective) scroll: PerfectScrollDirective;\r\n\r\n  @ViewChild('successUrlTpl') successUrlTpl: TemplateRef<any>;\r\n\r\n  constructor(\r\n    private cdr: ChangeDetectorRef,\r\n    private orderService: OrderServicesService,\r\n    private layoutService: LayoutSharedService,\r\n    private modalService: NzModalService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.loading.next(true);\r\n    this.sub = this.orderService.getK2Scenarios().subscribe((scenarios) => {\r\n      this.scenarios = scenarios;\r\n      this.loading.next(false);\r\n      this.cdr.detectChanges();\r\n    });\r\n    this.dateTimeFormat = this.orderService.dateTimeFormat$;\r\n  }\r\n\r\n  get currentStepAction(): StepAction | undefined {\r\n    return this.actions ? this.actions.slice().pop() : undefined;\r\n  }\r\n\r\n  get uuid(): string | undefined {\r\n    return this.currentStepAction ? this.currentStepAction.uuid : undefined;\r\n  }\r\n\r\n  getScenarioButtonType(scenario: Scenario): string {\r\n    return this.selectedScenario?.id === scenario?.id ? 'primary' : 'default';\r\n  }\r\n\r\n  nextAction(): void {\r\n    if (this.actions && this.actions.length > 0) {\r\n      this.getNextStep();\r\n    } else {\r\n      this.startScenario();\r\n    }\r\n  }\r\n\r\n  getNextStep(): void {\r\n    this.loading.next(true);\r\n    this.sub = this.orderService\r\n      .putK2SessionStep(this.currentStepAction)\r\n      .subscribe((action) => {\r\n        this.addNewStepAction(action);\r\n      });\r\n  }\r\n\r\n  startScenario() {\r\n    this.loading.next(true);\r\n    this.sub = this.orderService\r\n      .openK2Session(this.selectedScenario?.id)\r\n      .subscribe((action) => {\r\n        this.addNewStepAction(action);\r\n      });\r\n  }\r\n\r\n  selectScenario(scenario: Scenario): void {\r\n    if (this.actions?.length > 0) {\r\n      return;\r\n    }\r\n    this.selectedScenario = scenario;\r\n  }\r\n\r\n  private addNewStepAction(newAction: StepAction): void {\r\n    if (newAction) {\r\n      this.actions.push(newAction);\r\n    }\r\n    this.loading.next(false);\r\n    this.cdr.detectChanges();\r\n  }\r\n\r\n  commitSession(): void {\r\n    this.loading.next(true);\r\n    this.sub = this.orderService\r\n      .commitK2Session(this.uuid)\r\n      .subscribe((resultStatus) => {\r\n        this.url = resultStatus.data.k2RequestUrl;\r\n        this.showNotification(resultStatus.success);\r\n        this.loading.next(false);\r\n        this.resetSession();\r\n      });\r\n  }\r\n\r\n  resetSession(): void {\r\n    this.selectedScenario = undefined;\r\n    this.actions = [];\r\n    this.layoutService.toScrollTop$();\r\n  }\r\n\r\n  showNotification(success: boolean): void {\r\n    if (success) {\r\n      this.modalService.success({\r\n        nzTitle: 'Услуга заказана успешно',\r\n        nzContent: this.successUrlTpl,\r\n        // nzContent: 'Просмотр заказанных услуг доступен в системе К2',\r\n      });\r\n    } else if (success === false) {\r\n      this.modalService.error({\r\n        nzTitle: 'Не удалось заказать услугу',\r\n        nzContent: '',\r\n      });\r\n    }\r\n  }\r\n}\r\n","<nz-card\r\n  *ngIf=\"scenarios\"\r\n  [nzTitle]=\"'Заказ услуг | Выберите сценарий'\"\r\n  class=\"scenarios-card\"\r\n  [nzActions]=\"[actions?.length > 0 ? undefined : actionTmpl]\"\r\n>\r\n  <div nz-row [nzGutter]=\"[16, 24]\">\r\n    <div nz-col [nzSpan]=\"6\" *ngFor=\"let scenario of scenarios\">\r\n      <button\r\n        class=\"scenario-button\"\r\n        nz-button\r\n        [nzType]=\"getScenarioButtonType(scenario)\"\r\n        (click)=\"selectScenario(scenario)\"\r\n      >\r\n        {{ scenario.description }}\r\n      </button>\r\n    </div>\r\n  </div>\r\n</nz-card>\r\n\r\n<action-step-card\r\n  [title]=\"selectedScenario?.description\"\r\n  [action]=\"action\"\r\n  *ngFor=\"let action of actions; let i = index\"\r\n  [isLoading]=\"loading | async\"\r\n  [dateTimeFormat]=\"dateTimeFormat | async\"\r\n  (nextAction)=\"nextAction()\"\r\n  (commitSession)=\"commitSession()\"\r\n  (cancelSession)=\"resetSession()\"\r\n  [showActionTmpl]=\"actions?.length - 1 === i\"\r\n></action-step-card>\r\n\r\n<ng-template #successUrlTpl>\r\n  <div><span>Просмотр заказанных услуг доступен в системе К2.</span></div>\r\n  <div class=\"url-link\">\r\n    <a *ngIf=\"url\" [href]=\"url\" target=\"_blank\"\r\n      >Просмотр заявки в системе К2</a\r\n    >\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #actionTmpl>\r\n  <div class=\"action-tmpl\">\r\n    <button\r\n      nz-button\r\n      nzType=\"primary\"\r\n      [disabled]=\"!selectedScenario\"\r\n      [nzLoading]=\"loading | async\"\r\n      (click)=\"nextAction()\"\r\n    >\r\n      Далее\r\n    </button>\r\n  </div>\r\n</ng-template>\r\n","import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { ExtraTitleTplModule } from '@src/app/shared/layout/extra-title-tpl/extra-title-tpl.module';\r\nimport { NzButtonModule } from 'ng-zorro-antd/button';\r\nimport { NzCardModule } from 'ng-zorro-antd/card';\r\nimport { NzGridModule } from 'ng-zorro-antd/grid';\r\nimport { NzProgressModule } from 'ng-zorro-antd/progress';\r\nimport { NzFormModule } from 'ng-zorro-antd/form';\r\nimport { OfficeServicesRoutingModule } from './office-services-routing.module';\r\nimport { OfficeServicesomponent } from './page/office-services.component';\r\nimport { SharedOfficeServicesModule } from '@src/app/shared/office-services/shared-office-services.module';\r\nimport { ActionStepCardComponent } from './components/action-step-card/action-step-card.component';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\n\r\n@NgModule({\r\n  declarations: [OfficeServicesomponent, ActionStepCardComponent],\r\n  imports: [\r\n    CommonModule,\r\n    OfficeServicesRoutingModule,\r\n    SharedOfficeServicesModule,\r\n    ExtraTitleTplModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    NzButtonModule,\r\n    NzProgressModule,\r\n    NzCardModule,\r\n    NzGridModule,\r\n    NzFormModule\r\n  ],\r\n})\r\nexport class OfficeServicesModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { ExtraTitleTplComponent } from './extra-title-tpl.component';\r\n\r\n\r\n\r\n@NgModule({\r\n    declarations: [ExtraTitleTplComponent],\r\n    exports: [\r\n        ExtraTitleTplComponent\r\n    ]\r\n})\r\nexport class ExtraTitleTplModule { }\r\n"],"sourceRoot":"webpack:///"}