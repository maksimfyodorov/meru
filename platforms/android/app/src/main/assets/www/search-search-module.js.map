{"version":3,"sources":["./src/app/presentation/search/search.utils.ts","./src/app/presentation/search/search-routing.module.ts","./src/app/presentation/search/search.service.ts","./src/app/presentation/search/search.component.ts","./src/app/presentation/search/search.component.html","./src/app/presentation/search/search.module.ts"],"names":[],"mappings":"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","file":"search-search-module.js","sourcesContent":["import { SearchType } from '@presentation/search/search.model';\r\n\r\nexport const SEARCH_TYPES: SearchType[] = [ 'all', 'user', 'workplace', 'room', 'parkingLot', 'customObject' ];\r\nexport const TABS_TITLES: Record<SearchType, string> = {\r\n  all: 'All',\r\n  customObject: 'Custom objects',\r\n  room: 'Rooms',\r\n  user: 'Users',\r\n  workplace: 'Workplaces',\r\n  parkingLot: 'ParkingLots'\r\n};\r\n","import { RouterModule, Routes } from '@angular/router';\r\nimport { SearchComponent } from '@presentation/search/search.component';\r\nimport { NgModule } from '@angular/core';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    pathMatch: 'full',\r\n    component: SearchComponent\r\n  },\r\n  {\r\n    path: ':type',\r\n    component: SearchComponent\r\n  }, {\r\n    path: '**',\r\n    redirectTo: '/search'\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class SearchRoutingModule {}\r\n","import { Injectable } from '@angular/core';\r\nimport { ActivatedRoute, NavigationExtras } from '@angular/router';\r\nimport { combineLatest, Observable, of } from 'rxjs';\r\nimport { IResult, SearchType } from '@presentation/search/search.model';\r\nimport { map, pluck, switchMap, take } from 'rxjs/operators';\r\nimport { SEARCH_TYPES } from '@presentation/search/search.utils';\r\nimport { NavigationService } from '@core/services/navigation.service';\r\nimport { GlobalSearchService } from '@shared/global-search/global-search.service';\r\nimport { ISearchResult, ISearchResultGroup } from '@app/layout/header/models/header.search.model';\r\nimport { isEmpty } from '@core/utils/common.util';\r\nimport { GlobalSearchType } from '@shared/global-search/global-search.model';\r\n\r\n@Injectable()\r\nexport class SearchService {\r\n  constructor(\r\n    private $activatedRoute: ActivatedRoute,\r\n    private $navigation: NavigationService,\r\n    private $globalSearch: GlobalSearchService\r\n  ) {\r\n  }\r\n\r\n  /**\r\n   * @returns {Observable<string>} - запроса\r\n   */\r\n  public get query$(): any {\r\n    return this.$activatedRoute.queryParams.pipe(\r\n      pluck( 'query' ),\r\n      map( query => typeof query === 'string' ? query.trim().toLocaleLowerCase() : '' )\r\n    );\r\n  }\r\n\r\n  /**\r\n   * @returns {Observable<SearchType>} - тип поиска\r\n   */\r\n  public get type$(): any {\r\n    return this.$activatedRoute.params.pipe(\r\n      pluck( 'type' ),\r\n      map( ( type: SearchType ) => SEARCH_TYPES.includes( type ) ? type : 'all' )\r\n    );\r\n  }\r\n\r\n  /**\r\n   * @returns {Observable<number>} - начальный индекс вкладки\r\n   */\r\n  public get initialTabIndex$(): any {\r\n    return this.type$.pipe(\r\n      take( 1 ),\r\n      map( ( type: SearchType ) => SEARCH_TYPES.indexOf( type ) )\r\n    );\r\n  }\r\n\r\n  /**\r\n   * @returns {Observable<string>} - начальное значение запроса\r\n   */\r\n  public get initialQuery$(): any {\r\n    return this.query$.pipe(\r\n      take( 1 )\r\n    );\r\n  }\r\n\r\n  /**\r\n   * @returns {Observable<IResult>} - врезультат поиска\r\n   */\r\n  public get result$(): any {\r\n    return combineLatest( [ this.type$, this.query$ ] )\r\n      .pipe(\r\n        switchMap( ( [ type, query ]: [ SearchType, string ] ) =>\r\n          this.switchQueryToResult( type, query )\r\n        )\r\n      );\r\n  }\r\n\r\n  public search( query: string ): void {\r\n    this.$navigation.changeQueryParams( {query} ).then();\r\n  }\r\n\r\n  public changeType( index: number ): void {\r\n    const extras: NavigationExtras = {\r\n      queryParams: this.$activatedRoute.snapshot.queryParams\r\n    };\r\n\r\n    this.$navigation.go( [ 'search', SEARCH_TYPES[ index ] ], extras );\r\n  }\r\n\r\n  public openItem( type: GlobalSearchType, data: Record<string, any> ): void {\r\n    this.$globalSearch.openItem( type, data );\r\n  }\r\n\r\n  private switchQueryToResult( type: SearchType, query: string ): Observable<ISearchResult> {\r\n    let result$: Observable<ISearchResult | ISearchResultGroup>;\r\n\r\n    if (isEmpty( query )) {\r\n      return of( null );\r\n    }\r\n\r\n    switch (type) {\r\n      case 'customObject':\r\n        result$ = this.$globalSearch.searchCustomObjects( query );\r\n        break;\r\n\r\n      case 'room':\r\n        result$ = this.$globalSearch.searchRooms( query );\r\n        break;\r\n\r\n      case 'user':\r\n        result$ = this.$globalSearch.searchUsers( query );\r\n        break;\r\n\r\n      case 'workplace':\r\n        result$ = this.$globalSearch.searchWorkplaces( query );\r\n        break;\r\n\r\n        case 'parkingLot':\r\n        result$ = this.$globalSearch.searchParkingLots( query );\r\n        break;\r\n\r\n      default:\r\n        return this.$globalSearch.search( query );\r\n    }\r\n\r\n    return result$.pipe(\r\n      map( result =>\r\n        [].concat( result )\r\n      )\r\n    );\r\n  }\r\n}\r\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { SearchService } from '@presentation/search/search.service';\r\nimport { SEARCH_TYPES, TABS_TITLES } from '@presentation/search/search.utils';\r\nimport { IResult, SearchType } from '@presentation/search/search.model';\r\nimport { Subscribe } from '@core/decorators/subscribe.decorator';\r\nimport { map, tap } from 'rxjs/operators';\r\nimport { GlobalSearchType } from '@shared/global-search/global-search.model';\r\n\r\n@Component( {\r\n  selector: 'app-search',\r\n  templateUrl: './search.component.html',\r\n  styleUrls: [ './search.component.less' ],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  providers: [\r\n    SearchService\r\n  ]\r\n} )\r\nexport class SearchComponent implements OnInit, OnDestroy {\r\n  public searchTypes: SearchType[] = SEARCH_TYPES;\r\n  public tabsTitles: Record<SearchType, string> = TABS_TITLES;\r\n  public type: SearchType = 'all';\r\n\r\n  @Subscribe<string>()\r\n  public query: string = this.$service.query$;\r\n\r\n  @Subscribe<string>()\r\n  public initialQuery: string = this.$service.initialQuery$;\r\n\r\n  @Subscribe<number>()\r\n  public initialTabIndex: number = this.$service.initialTabIndex$;\r\n\r\n  @Subscribe<IResult | null>()\r\n  public result: IResult = this.$service.result$;\r\n\r\n  @Subscribe<number>()\r\n  public resultGroupPageSize: number = this.$service.type$.pipe(\r\n    tap( type => this.type = type as SearchType ),\r\n    map( type => type === 'all' ? 6 : 12 )\r\n  );\r\n\r\n  constructor(\r\n    private $cdr: ChangeDetectorRef,\r\n    private $service: SearchService\r\n  ) {\r\n  }\r\n\r\n  public search( query: string ): void {\r\n    this.$service.search( query );\r\n  }\r\n\r\n  public changeType( index: number ): void {\r\n    this.$service.changeType( index );\r\n  }\r\n\r\n  public openItem( type: GlobalSearchType, data: Record<string, any> ): void {\r\n    this.$service.openItem( type, data );\r\n  }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n  }\r\n}\r\n","<div class=\"search\">\r\n  <h2 nz-typography>\r\n    {{'HowCanWeHelpYou' | translate}}?\r\n  </h2>\r\n\r\n  <nz-form-item>\r\n    <nz-tabset [nzSelectedIndex]=\"initialTabIndex\"\r\n               [nzSize]=\"'large'\"\r\n               (nzSelectedIndexChange)=\"changeType($event)\"\r\n    >\r\n      <nz-tab *ngFor=\"let SearchType of searchTypes\"\r\n              [nzTitle]=\"tabsTitles[SearchType] | translate\"\r\n      >\r\n      </nz-tab>\r\n    </nz-tabset>\r\n\r\n    <nz-input-group [nzSuffixIcon]=\"'search'\"\r\n                    [nzSize]=\"'large'\"\r\n    >\r\n      <input nz-input\r\n             [placeholder]=\"'StartWritingWhatYouWantFind' | translate\"\r\n             [name]=\"'query'\"\r\n             [ngModel]=\"initialQuery\"\r\n             (ngModelChange)=\"search($event)\"\r\n      />\r\n    </nz-input-group>\r\n  </nz-form-item>\r\n\r\n  <perfect-scrollbar [config]=\"{suppressScrollX: true}\"\r\n                     class=\"search__scroll\"\r\n  >\r\n    <ng-container *ngIf=\"result; else noSearchQueryResultsTpl\">\r\n      <nz-list nzGrid *ngFor=\"let resultGroup of result\">\r\n        <nz-list-header>\r\n          <nz-row class=\"align-items-center\">\r\n            <nz-col [nzSpan]=\"12\"\r\n\r\n            >\r\n              <h3>{{resultGroup.title | translate}}</h3>\r\n            </nz-col>\r\n\r\n            <nz-col [nzSpan]=\"12\"\r\n                    class=\"text-right\"\r\n            >\r\n              <nz-pagination #paging=\"nzPagination\"\r\n                             [nzTotal]=\"resultGroup.items.length\"\r\n                             [nzPageSize]=\"resultGroupPageSize\"\r\n                             [nzSize]=\"'small'\"\r\n                             [ngStyle]=\"{display: resultGroup.items.length < resultGroupPageSize ? 'none' : 'block'}\"\r\n              >\r\n              </nz-pagination>\r\n            </nz-col>\r\n          </nz-row>\r\n        </nz-list-header>\r\n\r\n        <div nz-row\r\n             [nzGutter]=\"24\"\r\n        >\r\n          <nz-list-item *ngFor=\"let item of resultGroup.items | slice : ((paging.nzPageIndex - 1) * paging.nzPageSize) : ((paging.nzPageIndex) * paging.nzPageSize )\"\r\n                        nz-col\r\n                        [nzSpan]=\"12\"\r\n                        (click)=\"openItem(resultGroup.type, item.data)\"\r\n          >\r\n            <nz-list-item-meta>\r\n            <nz-list-item-meta-avatar [nzSrc]=\"item.img | imageBlob | async\"></nz-list-item-meta-avatar>\r\n            <nz-list-item-meta-title>\r\n              <span [innerHTML]=\"item.title\"></span>\r\n            </nz-list-item-meta-title>\r\n\r\n            <nz-list-item-meta-description [ngSwitch]=\"resultGroup.type\">\r\n              <ng-container *ngSwitchCase=\"'user'\">\r\n                <ng-container\r\n                  *ngTemplateOutlet=\"searchResultItemDescriptionUserTpl; context: {$implicit: item.data}\"></ng-container>\r\n              </ng-container>\r\n\r\n              <ng-container *ngSwitchCase=\"'customObject'\">\r\n                <ng-container\r\n                  *ngTemplateOutlet=\"searchResultItemReserveItemTpl; context: {$implicit: item.data}\"></ng-container>\r\n              </ng-container>\r\n\r\n              <ng-container *ngSwitchCase=\"'room'\">\r\n                <ng-container\r\n                  *ngTemplateOutlet=\"searchResultItemReserveItemTpl; context: {$implicit: item.data}\"></ng-container>\r\n              </ng-container>\r\n\r\n              <ng-container *ngSwitchCase=\"'workplace'\">\r\n                <ng-container\r\n                  *ngTemplateOutlet=\"searchResultItemReserveItemTpl; context: {$implicit: item.data}\"></ng-container>\r\n              </ng-container>\r\n\r\n              <ng-container *ngSwitchCase=\"'parkingLot'\">\r\n                <ng-container\r\n                  *ngTemplateOutlet=\"searchResultItemReserveItemTpl; context: {$implicit: item.data}\"></ng-container>\r\n              </ng-container>\r\n            </nz-list-item-meta-description>\r\n            </nz-list-item-meta>\r\n          </nz-list-item>\r\n\r\n          <nz-list-empty *ngIf=\"!resultGroup.items.length\" [nzNoResult]=\"emptySearchResultTpl\">\r\n\r\n          </nz-list-empty>\r\n        </div>\r\n      </nz-list>\r\n    </ng-container>\r\n  </perfect-scrollbar>\r\n</div>\r\n\r\n<ng-template #searchResultItemDescriptionUserTpl\r\n             let-data\r\n>\r\n   <span *ngIf=\"data.post\">\r\n     {{'Post'| translate}}: <span [innerHTML]=\"data.post | highlight : query\"></span>\r\n   </span>\r\n  <span *ngIf=\"data.post && (data.phones || data.mail)\">, </span>\r\n  <span *ngIf=\"data.phones\">\r\n    {{'Phones' | translate}}: <span [innerHTML]=\"data.phones | highlight : query\"></span>\r\n  </span>\r\n  <span *ngIf=\"data.phones && data.mail\">, </span>\r\n  <span *ngIf=\"data.mail\">\r\n    {{'Email' | translate}}: <span [innerHTML]=\"data.mail | highlight : query\"></span>\r\n  </span>\r\n</ng-template>\r\n\r\n<ng-template #searchResultItemReserveItemTpl\r\n             let-data\r\n>\r\n  {{'Building' | translate}}: {{data.building}}, {{'Floor' | translate}}: {{data.floor}}\r\n  <div *ngIf=\"data.description\"\r\n       [innerHTML]=\"data.description | highlight : query\"\r\n  >\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #emptySearchResultTpl>\r\n  <span nz-typography><strong>{{'EmptySearchResults' | translate}}</strong></span>\r\n</ng-template>\r\n\r\n<ng-template #emptyResultsIconTpl>\r\n  <i nz-icon nzType=\"frown\" nzTheme=\"outline\"></i>\r\n</ng-template>\r\n\r\n\r\n<ng-template #noSearchQueryResultsTpl>\r\n  <nz-empty [nzNotFoundContent]=\"noSearchQueryResultsContentTpl\"\r\n            [nzNotFoundImage]=\"noSearchQueryResultsIconTpl\"\r\n  ></nz-empty>\r\n</ng-template>\r\n\r\n<ng-template #noSearchQueryResultsContentTpl>\r\n  <span nz-typography><strong>{{'PleaseEnterQueryForSearch' | translate}}</strong></span>\r\n</ng-template>\r\n\r\n<ng-template #noSearchQueryResultsIconTpl>\r\n  <i nz-icon nzType=\"search\" nzTheme=\"outline\"></i>\r\n</ng-template>\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { SearchComponent } from './search.component';\r\nimport { CoreModule } from '@core/core.module';\r\nimport { SearchRoutingModule } from '@presentation/search/search-routing.module';\r\nimport { SearchService } from '@presentation/search/search.service';\r\nimport { GlobalSearchModule } from '@shared/global-search/global-search.module';\r\nimport { NzListModule } from 'ng-zorro-antd/list';\r\nimport { NzPaginationModule } from 'ng-zorro-antd/pagination';\r\nimport { ImagesModule } from '@shared/images/images.module';\r\n\r\n@NgModule({\r\n  declarations: [SearchComponent],\r\n  imports: [\r\n    CommonModule,\r\n    CoreModule.forChild(),\r\n    SearchRoutingModule,\r\n    GlobalSearchModule,\r\n    NzListModule,\r\n    NzPaginationModule,\r\n    ImagesModule\r\n  ]\r\n})\r\nexport class SearchModule { }\r\n"],"sourceRoot":"webpack:///"}